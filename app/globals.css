@tailwind base;
@tailwind components;
@tailwind utilities;

/* BASE – minimalne korekty */
@layer base {
  html {
    /* USUNIĘTO: scroll-behavior: smooth - powodowało baunsowanie */
    scroll-padding-top: calc(4.5rem + 1rem); /* h-header + dodatkowy padding */
    overscroll-behavior-y: none; /* zapobiega gumkowaniu na osi Y */
    overflow-x: hidden; /* unika artefaktu 1px na prawym brzegu w Chrome */
    width: 100%;
    background-color: theme('colors.bg-light'); /* tło na root, eliminuje biały szew */
  }

  body {
    @apply bg-bg-light text-text-dark dark:bg-bg-dark dark:text-text-light font-sans;
    /* ZAPOBIEGANIE LAYOUT SHIFT */
    overflow-x: hidden;
    width: 100%;
    overscroll-behavior-y: none;
    -webkit-font-smoothing: antialiased; /* redukcja shimmeringu tekstu w Chrome */
    text-rendering: optimizeLegibility;
  }

  :root {
    /* Domyślnie mapujemy pricedown na orbitron, dopóki nie podłączymy lokalnego fontu */
    --font-pricedown: var(--font-orbitron);
    /* Animation tokens */
    --dur-fast: 300ms;
    --dur-slow: 700ms;
    --dur-decay: 3000ms;
    --ease-brand: cubic-bezier(0.22, 1, 0.36, 1);
  }

  h1,
  h2,
  h3 {
    @apply font-display;
  }
}

/* COMPONENTS – tylko powtarzalne wzorce */
@layer components {
  /* Sekcje */
  .section-pad {
    @apply py-10 md:py-14;
  }

  .section-wrap {
    @apply container mx-auto px-4;
  }

  /* Unified button system */
  .btn-base {
    @apply inline-flex items-center justify-center rounded-lg px-4 py-2 font-medium transition-colors duration-300 focus-ring;
  }

  .btn-neon-blue {
    @apply btn-base bg-neon-blue bg-opacity-90 text-white hover:bg-neon-blue/90 shadow-glow;
  }

  .btn-neon-purple {
    @apply btn-base bg-neon-purple bg-opacity-90 text-white hover:bg-neon-purple/90 shadow-glow-purple;
  }

  /* Legacy button aliases removed after migration */

  /* Specialized button variants */
  .btn-offer {
    @apply btn-neon-purple px-8 py-1 rounded-l-lg rounded-r-none;
  }

  .btn-section {
    @apply btn-neon-blue px-8 py-3 font-normal;
  }

  .btn-cta-purple {
    @apply btn-neon-purple py-0.5 max-w-md mx-auto w-full;
  }

  .btn-cta-blue {
    @apply btn-neon-blue py-0.5 max-w-md mx-auto w-full;
  }

  /* Hero title offset */
  .hero-title-offset {
    @apply mt-0; /* neutralizacja po przejściu headera na fixed */
  }

  /* Typography scale utilities */
  .text-hero {
    @apply text-5xl md:text-6xl font-display font-bold uppercase;
    font-family: var(--font-bebas), var(--font-orbitron), var(--font-yantramanav), ui-sans-serif, system-ui;
    letter-spacing: 0.08em;
  }

  @media (min-width: 768px) {
    .text-hero {
      letter-spacing: 0.14em;
    }
  }

  .text-section-title {
    @apply text-3xl md:text-4xl font-display font-bold mb-12 text-center;
  }

  .text-subsection-title {
    @apply text-2xl md:text-3xl font-display font-bold mb-8 text-center;
  }

  /* Section title utilities - unifikacja dla komponentów *WithHeader */
  .section-title-light {
    @apply text-section-title text-text-light uppercase;
    font-family: var(--font-bebas), var(--font-orbitron), var(--font-yantramanav), ui-sans-serif, system-ui;
    letter-spacing: 0.12em;
  }

  .section-title-dark {
    @apply text-section-title text-text-dark uppercase;
    font-family: var(--font-bebas), var(--font-orbitron), var(--font-yantramanav), ui-sans-serif, system-ui;
    letter-spacing: 0.12em;
  }

  /* Formularze */
  .input {
    @apply w-full rounded-lg border px-4 py-3 text-text-dark focus:outline-none focus:border-neon-blue transition-colors disabled:opacity-50 disabled:cursor-not-allowed;
    border-color: theme('colors.border-border');
    background-color: theme('colors.bg-surface');
  }

  /* Input dla ciemnego tła (w modalu Oferty) */
  .input-dark {
    @apply w-full rounded-lg border px-4 py-3 text-text-light focus:outline-none focus:border-neon-purple transition-colors disabled:opacity-50 disabled:cursor-not-allowed;
    border-color: theme('colors.border-dark-input');
    background-color: theme('colors.bg-input-dark');
  }

  .input-error {
    @apply border;
    border-color: theme('colors.error');
  }

  .input-dark:focus {
    @apply shadow-[0_0_0_2px_rgba(192,132,252,0.2)];
  }

  /* Grid dla strony głównej */
  .sections-grid-auto {
    @apply grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6;
  }

  /* About Page - Komponenty */
  .about-card {
    @apply rounded-lg shadow-sm p-6 border hover:shadow-md hover:border-neon-blue/30 transition-all duration-300;
    border-color: theme('colors.border-border-light');
    background-color: theme('colors.bg-surface');
  }

  .about-quote {
    @apply rounded-lg p-8 shadow-2xl border-l-4 text-text-light border-l-neon-blue;
    background-color: theme('colors.modal');
  }

  .about-icon {
    @apply text-3xl mb-4 text-neon-blue;
  }

  /* Universal Card Components - z neon ramkami */
  /*
   * REGUŁY:
   * - Jasne tło (bg-surface) → ciemny kafelek + niebieski neon
   * - Ciemne tło (bg-bg-dark) → biały kafelek + fioletowy neon
   */

  /* Consolidated card variants - use these going forward */
  /* Karta z niebieską ramką - dla JASNEGO tła (karta CIEMNA) */
  .card-with-border-blue {
    @apply rounded-xl border-2 border-neon-blue/30 text-text-light shadow-md p-6 relative overflow-hidden transition-all duration-300;
    background-color: theme('colors.modal');
    box-shadow: 0 0 20px rgba(0, 153, 204, 0.15), 0 4px 6px rgba(0, 0, 0, 0.3); /* subtle neon glow + shadow */
  }

  .card-with-border-blue:hover {
    @apply shadow-lg border-neon-blue/60;
    transform: translateY(-4px);
    box-shadow: 0 0 30px rgba(0, 153, 204, 0.3), 0 8px 12px rgba(0, 0, 0, 0.4); /* stronger glow on hover */
  }

  /* Karta z fioletową ramką - dla CIEMNEGO tła (karta BIAŁA) */
  .card-with-border-purple {
    @apply rounded-xl border-2 border-neon-purple/30 shadow-md p-6 relative overflow-hidden transition-all duration-300;
    background-color: theme('colors.bg-surface');
    box-shadow: 0 0 20px rgba(192, 132, 252, 0.15), 0 4px 6px rgba(0, 0, 0, 0.1); /* subtle purple glow + shadow */
  }

  .card-with-border-purple:hover {
    @apply shadow-lg border-neon-purple/60;
    transform: translateY(-4px);
    box-shadow: 0 0 30px rgba(192, 132, 252, 0.3),
      0 8px 12px rgba(0, 0, 0, 0.15); /* stronger glow on hover */
  }

  /* Legacy card aliases removed after migration */

  /* Approach Cards - Dark Variant z fioletową obwódką (ciemne tło) */
  .approach-card-dark {
    @apply rounded-xl border-2 border-neon-purple/30 text-text-light shadow-md p-6 relative overflow-hidden transition-all duration-300;
    background-color: theme('colors.modal');
    box-shadow: 0 0 20px rgba(192, 132, 252, 0.15), 0 4px 6px rgba(0, 0, 0, 0.3); /* subtle purple glow + shadow */
  }

  .approach-card-dark:hover {
    @apply shadow-lg border-neon-purple/60;
    transform: translateY(-4px);
    box-shadow: 0 0 30px rgba(192, 132, 252, 0.3), 0 8px 12px rgba(0, 0, 0, 0.4); /* stronger glow on hover */
  }

  .qualification-icon {
    @apply text-3xl text-neon-blue;
  }

  .approach-icon {
    @apply text-3xl text-neon-purple;
  }

  /* Status messages */
  .message-success {
    @apply bg-success-light border border-success-border text-success px-4 py-3 rounded-lg;
  }

  .message-error {
    @apply bg-error-light border border-error-border text-error px-4 py-3 rounded-lg;
  }
}

/* UTILITIES – dostępność i skróty */
@layer utilities {
  /* Utility: padding-top równy wysokości headera (fixed) */
  .pt-header {
    padding-top: theme('height.header');
  }
  /* Debug (tylko w dev): podświetl elementy wykraczające poza viewport */
  html[data-debug-overflow='true'] [data-overflow='true'] {
    box-shadow: inset 0 0 0 2px red;
  }
  .focus-ring {
    @apply focus:outline-none focus-visible:ring-2 focus-visible:ring-neon-blue focus-visible:ring-offset-2;
  }

  /* Global focus-visible styling dla lepszej dostępności */
  *:focus-visible {
    @apply outline-none ring-2 ring-neon-blue ring-offset-2;
  }

  .sr-only {
    @apply absolute w-px h-px p-0 -m-px overflow-hidden whitespace-nowrap border-0;
    clip: rect(0, 0, 0, 0);
    clip-path: inset(50%);
  }

  /* Link patterns */
  .link-hover-neon {
    @apply text-text-light hover:text-neon-blue transition-colors duration-300;
  }

  .link-focus-neon {
    @apply link-hover-neon focus-ring;
  }

  /* Przyciski w galerii */
  .btn-close {
    @apply absolute top-4 right-4 bg-opacity-90 hover:bg-opacity-100 rounded-full p-2 focus-ring;
    background-color: theme('colors.bg-surface');
  }

  .btn-nav-arrow {
    @apply absolute top-1/2 -translate-y-1/2 bg-opacity-90 hover:bg-opacity-100 rounded-full p-2 focus-ring;
    background-color: theme('colors.bg-surface');
  }

  /* Loading spinner */
  .spinner {
    @apply w-10 h-10 border-4 border-t-neon-blue rounded-full animate-spin;
    border-color: theme('colors.border-border');
  }

  /* Shadow utilities dla neon blue glow */
  .shadow-glow-blue-weak {
    box-shadow: 0 0 6px rgba(0, 153, 204, 0.15);
  }

  .shadow-glow-blue-medium {
    box-shadow: 0 0 20px rgba(0, 153, 204, 0.25);
  }

  .shadow-glow-blue-strong {
    box-shadow: 0 0 28px rgba(0, 153, 204, 0.45);
  }

  .shadow-glow-blue-very-strong {
    box-shadow: 0 0 40px rgba(0, 153, 204, 0.75), 0 0 12px rgba(0, 153, 204, 0.6);
  }

  .shadow-glow-blue-decay {
    box-shadow: 0 0 24px rgba(0, 153, 204, 0.35), 0 0 8px rgba(0, 153, 204, 0.25);
  }

  /* Drop shadow utilities dla tekstu */
  .drop-shadow-glow-blue-weak {
    filter: drop-shadow(0 0 8px rgba(0, 153, 204, 0.35));
  }

  .drop-shadow-glow-blue-medium {
    filter: drop-shadow(0 0 10px rgba(0, 153, 204, 0.35));
  }

  .drop-shadow-glow-blue-strong {
    filter: drop-shadow(0 0 16px rgba(0, 153, 204, 0.7));
  }

  /* Transition duration utilities */
  .transition-dur-fast {
    transition-duration: var(--dur-fast);
  }

  .transition-dur-slow {
    transition-duration: var(--dur-slow);
  }

  .transition-dur-decay {
    transition-duration: var(--dur-decay);
  }

  /* Wymuszenie akceleracji GPU dla elementów powodujących migotanie w Chrome */
  .gpu {
    transform: translateZ(0);
    will-change: transform;
    backface-visibility: hidden;
  }
}

/* REDUCED MOTION – jedna implementacja */
@media (prefers-reduced-motion: reduce) {
  *,
  *::before,
  *::after {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
  }

  html {
    scroll-behavior: auto !important;
  }
}
