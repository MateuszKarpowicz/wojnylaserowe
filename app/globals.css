@tailwind base;
@tailwind components;
@tailwind utilities;

/* BASE – minimalne korekty */
@layer base {
  html {
    /* USUNIĘTO: scroll-behavior: smooth - powodowało baunsowanie */
    scroll-padding-top: calc(4.5rem + 1rem); /* h-header + dodatkowy padding */
    overscroll-behavior-y: none; /* zapobiega gumkowaniu na osi Y */
    overflow-x: hidden; /* unika artefaktu 1px na prawym brzegu w Chrome */
    width: 100%;
    background-color: theme('colors.bg-light'); /* tło na root, eliminuje biały szew */
  }

  body {
    @apply bg-bg-light text-text-dark dark:bg-bg-dark dark:text-text-light font-sans;
    /* ZAPOBIEGANIE LAYOUT SHIFT */
    overflow-x: hidden;
    width: 100%;
    overscroll-behavior-y: none;
    -webkit-font-smoothing: antialiased; /* redukcja shimmeringu tekstu w Chrome */
    text-rendering: optimizeLegibility;
  }

  :root {
    /* Domyślnie mapujemy pricedown na orbitron, dopóki nie podłączymy lokalnego fontu */
    --font-pricedown: var(--font-orbitron);
    /* Animation tokens */
    --dur-fast: 300ms;
    --dur-slow: 700ms;
    --dur-decay: 3000ms;
    --ease-brand: cubic-bezier(0.22, 1, 0.36, 1);
  }

  h1,
  h2,
  h3 {
    @apply font-display;
  }
}

/* COMPONENTS – tylko powtarzalne wzorce */
@layer components {
  /* Sekcje */
  .section-pad {
    @apply py-10 md:py-14;
  }

  /* NOTE: .section-wrap removed - use Container component from primitives instead */

  /* Button system przeniesiony do Button.js jako Tailwind classes w cva */
  /* Używaj komponentu <Button variant="..."> zamiast bezpośrednich klas CSS */

  /* Hero title offset */
  .hero-title-offset {
    @apply mt-0; /* neutralizacja po przejściu headera na fixed */
  }

  /* Typography scale utilities */
  .text-hero {
    @apply text-5xl md:text-6xl font-display font-bold uppercase;
    font-family: var(--font-bebas), var(--font-orbitron), var(--font-yantramanav), ui-sans-serif, system-ui;
    letter-spacing: 0.08em;
  }

  @media (min-width: 768px) {
    .text-hero {
      letter-spacing: 0.14em;
    }
  }

  .text-section-title {
    @apply text-3xl md:text-4xl font-display font-bold mb-12 text-center;
  }

  .text-subsection-title {
    @apply text-2xl md:text-3xl font-display font-bold mb-8 text-center;
  }

  /* Section title utilities - unifikacja dla komponentów *WithHeader */
  .section-title-light {
    @apply text-section-title text-text-light uppercase;
    font-family: var(--font-bebas), var(--font-orbitron), var(--font-yantramanav), ui-sans-serif, system-ui;
    letter-spacing: 0.12em;
  }

  .section-title-dark {
    @apply text-section-title text-text-dark uppercase;
    font-family: var(--font-bebas), var(--font-orbitron), var(--font-yantramanav), ui-sans-serif, system-ui;
    letter-spacing: 0.12em;
  }

  /* Formularze */
  .input {
    @apply w-full rounded-lg border px-4 py-3 text-text-dark focus:outline-none focus:border-neon-blue transition-colors disabled:opacity-50 disabled:cursor-not-allowed;
    border-color: theme('colors.border-border');
    background-color: theme('colors.bg-surface');
  }

  /* Input dla ciemnego tła (w modalu Oferty) */
  .input-dark {
    @apply w-full rounded-lg border px-4 py-3 text-text-light focus:outline-none focus:border-neon-purple transition-colors disabled:opacity-50 disabled:cursor-not-allowed;
    border-color: theme('colors.border-dark-input');
    background-color: theme('colors.bg-input-dark');
  }

  .input-error {
    @apply border;
    border-color: theme('colors.error');
  }

  .input-dark:focus {
    @apply shadow-focus-purple;
  }

  /* Grid dla strony głównej */
  .sections-grid-auto {
    @apply grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6;
  }

  /* About Page - Komponenty */
  .about-card {
    @apply rounded-lg shadow-sm p-6 border hover:shadow-md hover:border-neon-blue/30 transition-all duration-300;
    border-color: theme('colors.border-border-light');
    background-color: theme('colors.bg-surface');
  }

  .about-quote {
    @apply rounded-lg p-8 shadow-2xl border-l-4 text-text-light border-l-neon-blue;
    background-color: theme('colors.modal');
  }


  /* Universal Card Components - z neon ramkami */
  /*
   * REGUŁY:
   * - Jasne tło (bg-surface) → ciemny kafelek + niebieski neon
   * - Ciemne tło (bg-bg-dark) → biały kafelek + fioletowy neon
   *
   * Style kart przeniesione do tailwind.config.js jako shadow tokens (card-blue, card-purple)
   * oraz do Card.js jako klasy Tailwind zamiast custom CSS classes.
   * Używaj komponentu <Card variant="blue"> zamiast bezpośrednich klas CSS.
   */

  /* Legacy card aliases removed after migration */

  /* NOTE: .approach-card-dark removed - use .card-with-border-blue instead (identical styles) */


  /* Status messages */
  .message-success {
    @apply bg-success-light border border-success-border text-success px-4 py-3 rounded-lg;
  }

  .message-error {
    @apply bg-error-light border border-error-border text-error px-4 py-3 rounded-lg;
  }
}

/* UTILITIES – dostępność i skróty */
@layer utilities {
  /* Utility: padding-top równy wysokości headera (fixed) */
  .pt-header {
    padding-top: theme('height.header');
  }
  /* Debug (tylko w dev): podświetl elementy wykraczające poza viewport */
  html[data-debug-overflow='true'] [data-overflow='true'] {
    box-shadow: inset 0 0 0 2px red;
  }
  .focus-ring {
    @apply focus:outline-none focus-visible:ring-2 focus-visible:ring-neon-blue focus-visible:ring-offset-2;
  }

  /* Global focus-visible styling dla lepszej dostępności */
  *:focus-visible {
    @apply outline-none ring-2 ring-neon-blue ring-offset-2;
  }

  .sr-only {
    @apply absolute w-px h-px p-0 -m-px overflow-hidden whitespace-nowrap border-0;
    clip: rect(0, 0, 0, 0);
    clip-path: inset(50%);
  }

  /* Link patterns */
  .link-hover-neon {
    @apply text-text-light hover:text-neon-blue transition-colors duration-300;
  }

  .link-focus-neon {
    @apply link-hover-neon focus-ring;
  }

  /* Przyciski w galerii */
  .btn-close {
    @apply absolute top-4 right-4 bg-opacity-90 hover:bg-opacity-100 rounded-full p-2 focus-ring;
    background-color: theme('colors.bg-surface');
  }

  .btn-nav-arrow {
    @apply absolute top-1/2 -translate-y-1/2 bg-opacity-90 hover:bg-opacity-100 rounded-full p-2 focus-ring;
    background-color: theme('colors.bg-surface');
  }

  /* Loading spinner */
  .spinner {
    @apply w-10 h-10 border-4 border-t-neon-blue rounded-full animate-spin;
    border-color: theme('colors.border-border');
  }

  /* Shadow utilities przeniesione do tailwind.config.js - używaj shadow-* i drop-shadow-* classes */
  /* Transition duration utilities */
  .transition-dur-fast {
    transition-duration: var(--dur-fast);
  }

  .transition-dur-slow {
    transition-duration: var(--dur-slow);
  }

  .transition-dur-decay {
    transition-duration: var(--dur-decay);
  }

  /* Wymuszenie akceleracji GPU dla elementów powodujących migotanie w Chrome */
  .gpu {
    transform: translateZ(0);
    will-change: transform;
    backface-visibility: hidden;
  }

  /* Safe area insets (iOS notch, home bar, etc.) */
  .pt-safe {
    padding-top: max(env(safe-area-inset-top), 0px);
  }

  .pb-safe {
    padding-bottom: max(env(safe-area-inset-bottom), 0px);
  }

  .pl-safe {
    padding-left: max(env(safe-area-inset-left), 0px);
  }

  .pr-safe {
    padding-right: max(env(safe-area-inset-right), 0px);
  }

  .px-safe {
    padding-left: max(env(safe-area-inset-left), 0px);
    padding-right: max(env(safe-area-inset-right), 0px);
  }

  .py-safe {
    padding-top: max(env(safe-area-inset-top), 0px);
    padding-bottom: max(env(safe-area-inset-bottom), 0px);
  }
}

/* REDUCED MOTION – jedna implementacja */
@media (prefers-reduced-motion: reduce) {
  *,
  *::before,
  *::after {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
  }

  html {
    scroll-behavior: auto !important;
  }
}
